---
title: "Menu Cost"
author: "Cheng,Tien"
date: "2023-08-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("R/support.R")
library(targets)
library(dplyr)
library(ggplot2)
library(gridExtra)
tar_load(AverageInflationRatePercentage)
tar_load(c(popularItems,average_menu_cost_wax_before,average_menu_cost_wax_after,
           average_menu_cost_wane_before,average_menu_cost_wane_after))
tar_load(c(filtered_average_inflation_rate_wax,filtered_average_inflation_rate_wane))
tar_load(c(menu_wax,menu_wane))
tar_load(c(persistent_popularItems_count,table_persistent_popularItems_count))
tar_load(mealOffering_shopCodes)
tar_load(business_hour_types)
tar_load(menu_wax_offerMeal)
tar_load(tracking_shopCodes_mealOffering)
tar_load(c(cpi_wax,cpi_wane,tb_cpi_summary))
tar_load(c(summary_price_wax_before,summary_price_wax_after,summary_price_wane_after,tb_price_summary))
tar_load(c(summary_AvgPrice_wax_before,summary_AvgPrice_wax_after,
           summary_AvgPrice_wane_after,tb_AvgPrice_summary))
tar_load(c(summary_byGroup_wax_before,
         summary_byGroup_wax_after,
         summary_byGroup_wane_after,
         tb_price_byGroup_summary))
tar_load(tracking_shopCodes_mealOffering_6popularItems)
tar_load(c(menu_cost_wax_before,menu_cost_wax_after,menu_cost_wane_after,
           wax_data_before,wax_data_after,wane_data_after))
knitr::opts_chunk$set(echo = FALSE)
```

#### 計算平均物價有上漲的店家佔總店家比例

-   蛋荒較嚴重時，有較高比例的店家物價是上漲的

|period | percentage|
|:------|----------:|
|wax    |  0.2871515|
|wane   |  0.2509112|

```{r}
AverageInflationRatePercentage<-data.frame(period=c("wax","wane"),
                                           percentage=c(compute_percentage(filtered_average_inflation_rate_wax),compute_percentage(filtered_average_inflation_rate_wane)))
```

#### wax物價上漲率之四分位值

|     |           |
|:----|----------:|
|0%   | -1.5629639|
|25%  |  0.0000000|
|50%  |  0.0000000|
|75%  |  0.0170736|
|100% |  1.6669364|

```{r}
data <- data.frame(values = filtered_average_inflation_rate_wax$inflation_rate)
ggplot(data, aes(x = values)) +
  geom_histogram(binwidth = 1,breaks=seq(-1.5, 1.5, by = 0.02), fill = "skyblue", color = "black") +
  labs(title = "Histogram of Inflation Rates") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20),
  )
```


#### wane物價上漲率之四分位值
|     |           |
|:----|----------:|
|0%   | -1.8050047|
|25%  |  0.0000000|
|50%  |  0.0000000|
|75%  |  0.0016175|
|100% |  2.0152448|

```{r}
data <- data.frame(values = filtered_average_inflation_rate_wane$inflation_rate)
ggplot(data, aes(x = values)) +
  geom_histogram(binwidth = 1,breaks=seq(-1.5, 1.5, by = 0.02), fill = "skyblue", color = "black") +
  labs(title = "Histogram of Inflation Rates") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20),
  )
```







#### 蛋荒較嚴重時期

##### 一、先觀察物價上漲率大於1的店家，總共有68間
|shopCode | inflation_rate|
|:--------|--------------:|
|lh86     |       1.666936|
|e1iw     |       1.544980|
|m8pq     |       1.513661|
|q8sf     |       1.470082|
|seuv     |       1.463255|
|d1ls     |       1.392725|
|a1ef     |       1.377926|
|b2np     |       1.377926|
|d4hj     |       1.377926|
|i3cc     |       1.377926|
|s5te     |       1.377926|
|y0yj     |       1.377926|
|ynqu     |       1.377926|
|z4nx     |       1.377926|
|z5va     |       1.377926|
|pr81     |       1.368276|
|b8db     |       1.356694|
|e3jc     |       1.356694|
|e7bo     |       1.356694|
|jedi     |       1.356694|
|q6yu     |       1.356694|
|lsd5     |       1.346513|
|z7ko     |       1.318491|
|z3bf     |       1.301379|
|y2de     |       1.297883|
|y9tu     |       1.297883|
|z4wd     |       1.297883|
|a0ba     |       1.297767|
|y7lb     |       1.272566|
|y1ys     |       1.270593|
|y9yy     |       1.270593|
|a5ji     |       1.251946|
|z0zd     |       1.237684|
|cysg     |       1.234744|
|b9xu     |       1.217724|
|awvt     |       1.178655|
|o2kj     |       1.163151|
|vl3z     |       1.152680|
|pefn     |       1.150135|
|s6bd     |       1.144223|
|z2km     |       1.144223|
|lz5w     |       1.140634|
|y7ht     |       1.139434|
|p5au     |       1.137979|
|artg     |       1.124208|
|t4bt     |       1.124208|
|z9uh     |       1.124208|
|t2jb     |       1.092371|
|zmrx     |       1.091177|
|n4xa     |       1.086190|
|mi87     |       1.078410|
|y4id     |       1.060872|
|bj3q     |       1.058538|
|tceg     |       1.041160|
|d3sc     |       1.039642|
|l0q6     |       1.039642|
|xdj5     |       1.036009|
|c2dr     |       1.019872|
|r2is     |       1.014143|
|u9kk     |       1.005522|
|t7wo     |       1.001929|
|d0gl     |       1.000428|
|d1sd     |       1.000428|
|e7yc     |       1.000428|
|e9ke     |       1.000428|
|l6pf     |       1.000428|
|z0rb     |       1.000428|
|z7je     |       1.000428|

```{r,include=FALSE}
filtered_average_inflation_rate_wax|>
  dplyr::filter(inflation_rate>1)|>
  arrange(desc(inflation_rate))
```

##### *再取出物價上漲率最高的三間做觀察*

##### **shopcode為lh86店家**
|period | averageCost|
|:------|-----------:|
|before |      39.690|
|after  |     210.195|



##### lh86店家的熱門品項

```{r}
popularItems["lh86"]
```

##### lh86店家在wane_before的菜單

```{r}
menu_wax$before["lh86"]|>jsonlite::fromJSON()->lh86_wax_before
lh86_wax_before$product
```

##### lh86店家在wane_after的菜單

```{r}
menu_wax$after["lh86"]|>jsonlite::fromJSON()->lh86_wax_after
lh86_wax_after$product
```

-   可以發現在before時只有計算到[胡麻豆腐]的價格
-   after則是抓取[御上蒲燒鰻魚餐盒、胡麻豆腐]的價格
-   但熱門品項[聖選之最舒肥牛板腱餐盒、御膳牛五花餐盒、滿肉饗宴牛五花燒肉丼、客選雙拼牛五花燒肉丼]並未出現在wane時期的菜單裡，我猜測這幾個品項是蛋荒較趨緩時才推出的商品

##### **shopcode為e1iw店家**
|period | averageCost|
|:------|-----------:|
|before |     55.0000|
|after  |    257.8333|



##### e1iw店家的熱門品項

```{r}
popularItems["e1iw"]
```

##### e1iw店家在wane_before的菜單

```{r}
menu_wax$before["e1iw"]|>jsonlite::fromJSON()->e1iw_wax_before
e1iw_wax_before$product
```

##### e1iw店家在wane_after的菜單
```{r}
menu_wax$after["e1iw"]|>jsonlite::fromJSON()-> e1iw_wax_after
e1iw_wax_after$product

```



-   可以發現到造成價格的差異來自於品項名稱定義的不同，before的套餐皆無用【】符號。
-   假設before和after的套餐內容並無實際差別，且在before的"混搭餐"跟after的"腿塊混搭餐"是同樣商品，則抓出價格比較

|product        |February| April|
|:--------------|-------:|-----:|
|2號餐          |     140|   150|
|3號餐          |     175|   189|
|4號餐          |     185|   195|
|5號全家餐      |     399|   439|
|腿塊混搭餐     |     479|   509|
|波霸脆薯條(小) |      55|    65|

```{r,include=FALSE}
data.frame(product=c("2號餐","3號餐","4號餐",
                     "5號全家餐","腿塊混搭餐","波霸脆薯條(小)"),
           before=c(140,175,185,399,479,55),
           after=c(150,189,195,439,509,65))
```

-   可以發現到熱門品項的價格皆有上漲的趨勢，上漲的幅度大概在10元至40元不等

##### **shopcode為m8pq店家**
|period | averageCost|
|:------|-----------:|
|before |        60.0|
|after  |       272.6|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wax_before["m8pq"],
                               average_menu_cost_wax_after["m8pq"]))

```

##### m8pq店家的熱門品項

```{r}
popularItems["m8pq"]
```

##### m8pq店家在wane_before的菜單

```{r}
menu_wax$before["m8pq"]|>jsonlite::fromJSON()->m8pq_wax_before
m8pq_wax_before$product
```

##### m8pq店家在wane_after的菜單

```{r}
menu_wax$after["m8pq"]|>jsonlite::fromJSON()->m8pq_wax_after
m8pq_wax_after$product
```

-   可以發現到這間店和第二間一樣都是胖老爹炸雞，熱門品項也大致相同（少了3號餐，多了雞腿的品項）。
-   比較特別的是熱門品項[波霸脆薯條(小)]並無出現在after的菜單裡，速食店居然會有沒賣薯條的時候。
-   一樣將它的價格取出並做比較及觀察

|product        |February| April|
|:--------------|-------:|-----:|
|2號餐          |     140|   150|
|4號餐          |     185|   195|
|5號全家餐      |     399|   439|
|腿塊混搭餐     |     479|   509|
|雞腿           |      65|    70|
|波霸脆薯條(小) |      55|    NA|

```{r,include=FALSE}
data.frame(product=c("2號餐","4號餐","5號全家餐",
                     "腿塊混搭餐","雞腿","波霸脆薯條(小)"),
           before=c(140,185,399,479,65,55),
           after=c(150,195,439,509,70,NA))
```

-   可以發現到胖老爹熱門套餐類的漲幅都是相同的　　
-   由於有兩間是相同的胖老爹炸雞，但處於不同分店，再取出第四間店觀察

##### **shopcode為q8sf店家**
|period | averageCost|
|:------|-----------:|
|before |     41.0000|
|after  |    178.3333|


```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wax_before["q8sf"],
                               average_menu_cost_wax_after["q8sf"]))
```

##### q8sf店家的熱門品項

```{r}
popularItems["q8sf"]
```

##### q8sf店家在wane_before的菜單

```{r}
menu_wax$before["q8sf"]|>jsonlite::fromJSON()->q8sf_wax_before
q8sf_wax_before$product
```

##### q8sf店家在wane_after的菜單

```{r}
menu_wax$after["q8sf"]|>jsonlite::fromJSON()->q8sf_wax_after
q8sf_wax_after$product
```

-   可以觀察到造成物價上漲的原因也是來自於品項定義的不同，在before的名稱裡並無詳述餐點內容，但在after的套餐裡有詳細說明，如[ A套餐：個人份雞肉5配菜、B套餐：半隻雞4配菜、C套餐：半隻雞7配菜]
-   假設套餐組合的內容物相同，取出價格比較

|product             |February| April|
|:-------------------|------:|-----:|
|個人份雞肉【綜合部位】  |     70|    80|
|海帶根X2            |     25|    25|
|A套餐：個人份雞肉5配菜 |    210|   225|
|B套餐：半隻雞4配菜  |    280|   310|
|C套餐：半隻雞7配菜  |    360|   395|
|水蓮菜              |     28|    35|

```{r,include=FALSE}
data.frame(product=c("個人份雞肉【綜合部位】","海帶根X2","A套餐：個人份雞肉5配菜",
                     "B套餐：半隻雞4配菜","C套餐：半隻雞7配菜","水蓮菜"),
           before=c(70,25,210,280,360,28),
           after=c(80,25,225,310,395,35))
```

-   套餐類皆漲15至35元不等，而水蓮菜的漲幅來到了25%，上漲的幅度驚人

##### 小結

-   會有超過100%的成本上漲率，第一個原因來自於菜單內容的改變，前期還未推出的產品在後期推出，會形成計算平均價格的差異；而第二個原因來自於品項名稱定義的差異，在這種情形前後期菜單是相同的，但在命名上的不同會造成before沒抓到熱門品項而after有抓到，形成平均價格差異甚大的狀況。但第二種情形還能用觀察的再抓出價格做比較

##### 二、觀察物價上漲率小於-1的店家，總共有4間
|     |shopCode | inflation_rate|
|:----|:--------|--------------:|
|uvrf |uvrf     |      -1.562964|
|wdl7 |wdl7     |      -1.386294|
|j0ev |j0ev     |      -1.252763|
|r8ws |r8ws     |      -1.206193|

```{r,include=FALSE}
filtered_average_inflation_rate_wax|>dplyr::filter(inflation_rate<(-1))|>
  arrange(inflation_rate)
```

##### 觀察是否跟前一章節相同，是因為品項名稱定義造成

##### **shopcode為uvrf店家**
|period | averageCost|
|:------|-----------:|
|before |    329.3333|
|after  |     69.0000|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wax_before["uvrf"],
                               average_menu_cost_wax_after["uvrf"]))
```

##### uvrf店家的熱門品項

```{r}
popularItems["uvrf"]
```

##### uvrf店家在wane_before的菜單

```{r}
menu_wax$before["uvrf"]|>jsonlite::fromJSON()->uvrf_wax_before
uvrf_wax_before$product
```

##### uvrf店家在wane_after的菜單

```{r}
menu_wax$after["uvrf"]|>jsonlite::fromJSON()->uvrf_wax_after
uvrf_wax_after$product
```

-   可以看出[黑森林蛋糕【六吋】]只出現在before的菜單裡，after只有八吋的黑森林蛋糕，而整模的蛋糕屬於菜單裡較高單價的商品(六吋黑森林蛋糕850、八吋黑森林蛋糕1063)，會使before的平均物價高出許多

##### **shopcode為wdl7店家**
|period | averageCost|
|:------|-----------:|
|before |         140|
|after  |          35|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wax_before["wdl7"],
                               average_menu_cost_wax_after["wdl7"]))
```

##### wdl7店家的熱門品項

```{r}
popularItems["wdl7"]
```

##### wdl7店家在wane_before的菜單

```{r}
menu_wax$before["wdl7"]|>jsonlite::fromJSON()->wdl7_wax_before
wdl7_wax_before$product
```

##### wdl7店家在wane_after的菜單

```{r}
menu_wax$after["wdl7"]|>jsonlite::fromJSON()->wdl7_wax_after
wdl7_wax_after$product
```

-   before和after的菜單有些許不同，而after又只抓取到[香酥雞排（單點）]的資料。想比較這個品項在前後期的價格，但發現如果以[香酥雞排]這個名稱對應，before的價格是50元而after是35元，有點好奇一般店家會一次降15元嗎？（還是內容物不同？）

|item           | price|
|:--------------|-----:|
|香酥雞排       |    50|
|香酥雞排（單點） |    35|

```{r,include=FALSE}
data.frame(item=wdl7_wax_before$product,
           price=wdl7_wax_before$discountedPrice)|>
  dplyr::filter(item=="香酥雞排") -> wd17_before
data.frame(item=wdl7_wax_after$product,
           price=wdl7_wax_after$discountedPrice)|>
  dplyr::filter(item=="香酥雞排（單點）") -> wd17_after
bind_rows(wd17_before,wd17_after)
```

##### **shopcode為j0ev店家**
|period | averageCost|
|:------|-----------:|
|before |         105|
|after  |          30|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wax_before["j0ev"],
                               average_menu_cost_wax_after["j0ev"]))
```

##### j0ev店家的熱門品項

```{r}
popularItems["j0ev"]
```

##### j0ev店家在wane_before的菜單

```{r}
menu_wax$before["j0ev"]|>jsonlite::fromJSON()->j0ev_wax_before
j0ev_wax_before$product
```

##### j0ev店家在wane_after的菜單

```{r}
menu_wax$after["j0ev"]|>jsonlite::fromJSON()->j0ev_wax_after
j0ev_wax_after$product
```

-   此間店前後的商品差距甚大，不禁好奇這是哪間店？只有飲料的部分前後期相同，主食方面菜單大改。

##### **shopcode為r8ws店家**
|period | averageCost|
|:------|-----------:|
|before |    150.3333|
|after  |     45.0000|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wax_before["r8ws"],
                               average_menu_cost_wax_after["r8ws"]))
```

##### r8ws店家的熱門品項

```{r}
popularItems["r8ws"]
```

##### r8ws店家在wane_before的菜單

```{r}
menu_wax$before["r8ws"]|>jsonlite::fromJSON()->r8ws_wax_before
r8ws_wax_before$product
```

##### r8ws店家在wane_after的菜單

```{r}
menu_wax$after["r8ws"]|>jsonlite::fromJSON()->r8ws_wax_after
r8ws_wax_after$product
```

-   after的菜單裡主食都消失了，只剩飲料部分還存在

#### 蛋荒較趨緩時期

##### 一、先觀察物價上漲率大於1的店家，總共有20間
|shopCode | inflation_rate|
|:--------|--------------:|
|k5al     |       2.015245|
|w88l     |       1.937942|
|kccq     |       1.394327|
|r8ws     |       1.360407|
|vd0e     |       1.324292|
|l37o     |       1.303895|
|wdl7     |       1.280934|
|il9w     |       1.264462|
|jg2r     |       1.243582|
|edqs     |       1.238401|
|j05a     |       1.176179|
|wp6x     |       1.167169|
|cii4     |       1.143374|
|dgj1     |       1.140915|
|cf1p     |       1.120591|
|v3nv     |       1.069150|
|jz50     |       1.059472|
|chpw     |       1.040343|
|z1xk     |       1.029619|
|pb2n     |       1.023939|

```{r,include=FALSE}
filtered_average_inflation_rate_wane|>
  dplyr::filter(inflation_rate>1)|>
  arrange(desc(inflation_rate))
```

##### *再取出物價上漲率最高的三間做觀察*

##### **shopcode為k5al店家**
|period | averageCost|
|:------|-----------:|
|before |        39.0|
|after  |       292.6|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wane_before["k5al"],
                               average_menu_cost_wane_after["k5al"]))

```

##### k5al店家的熱門品項

```{r}
popularItems["k5al"]
```

##### k5al店家在wane_before的菜單

```{r}
menu_wane$before["k5al"]|>jsonlite::fromJSON()->k5al_wane_before
k5al_wane_before$product
```

##### k5al店家在wane_after的菜單

```{r}
menu_wane$after["k5al"]|>jsonlite::fromJSON()->k5al_wane_after
k5al_wane_after$product
```

-   可以發現到在after的菜單裡除了中文以外還加入了日文及英文，造成抓取品項名稱的差異
-   取出前後期價格來比較

|product                                   | April | July |
|:-----------------------------------------|------:|-----:|
|熟成嫩肩牛排300gミスジ Blade steak        |    438|   438|
|熟成骰子牛200gサイコロ牛 Diced beef steak |    328|   328|
|熟成骰子牛300gサイコロ牛 Diced beef steak |    438|   438|
|起司漢堡排Hamburg                         |     NA|    NA|
|豬排250g/豚ステーキpork chop              |    220|   220|
|馬鈴薯沙拉                                |     39|    39|

```{r,include=FALSE}
k5al_before<- data.frame(item=k5al_wane_before$product,
                         price=k5al_wane_before$discountedPrice)
k5al_after<- data.frame(item=k5al_wane_after$product,
                         price=k5al_wane_after$discountedPrice)

data.frame(product=c("熟成嫩肩牛排300gミスジ Blade steak",
                     "熟成骰子牛200gサイコロ牛 Diced beef steak",
                     "熟成骰子牛300gサイコロ牛 Diced beef steak",
                     "起司漢堡排Hamburg",
                     "豬排250g/豚ステーキpork chop",
                     "馬鈴薯沙拉"),
           before=c(438,328,438,NA,220,39),
           after=c(438,328,438,NA,220,39))

```

-   假設before的[安格斯混切骰子牛]就是after的[熟成骰子牛]，比較前後期差異可以發現到這間店的價格其實沒有調漲

##### **shopcode為w88l店家**
|period | averageCost|
|:------|-----------:|
|before |        45.0|
|after  |       312.5|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wane_before["w88l"],
                               average_menu_cost_wane_after["w88l"]))

```

##### w88l店家的熱門品項

```{r}
popularItems["w88l"]
```

##### w88l店家在wane_before的菜單

```{r}
menu_wane$before["w88l"]|>jsonlite::fromJSON()->w88l_wane_before
w88l_wane_before$product
```

##### w88l店家在wane_after的菜單

```{r}
menu_wane$after["w88l"]|>jsonlite::fromJSON()->w88l_wane_after
w88l_wane_after$product
```

-   可以發現這間店的前後期商品內容物不盡相同，before是以大、中、小沙鍋菜販售，after則是除了沙鍋菜外有加入其他肉品做綁售，此間店家的前後期價格較難以同一標準做比較。

##### **shopcode為kccq店家**
|period | averageCost|
|:------|-----------:|
|before |        55.8|
|after  |       225.0|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wane_before["kccq"],
                               average_menu_cost_wane_after["kccq"]))

```

##### kccq店家的熱門品項

```{r}
popularItems["kccq"]
```

##### kccq店家在wane_before的菜單

```{r}
menu_wane$before["kccq"]|>jsonlite::fromJSON()->kccq_wane_before
kccq_wane_before$product
```

##### kccq店家在wane_after的菜單

```{r}
menu_wane$after["kccq"]|>jsonlite::fromJSON()->kccq_wane_after
kccq_wane_after$product
```

-   可以發現這間店也是因為命名上的差異造成物價上漲率之高，比較兩者價格

|product                         | April| July|
|:-------------------------------|------:|-----:|
|(8葷12素)小鮮肉麻辣拌(乾拌)   |     NA|   235|
|(8葷12素)小鮮肉麻辣燙(好湯) |  152.1|   235|
|(3葷12素)小仙女麻辣拌(乾拌)  |     NA|   205|
|麻辣鴨血                        |   45.0|    NA|
|涼皮                            |   72.9|    NA|
|三合一湯                        |   49.5|    NA|

```{r,include=FALSE}
kccq_before<- data.frame(item=kccq_wane_before$product,
                         price=kccq_wane_before$discountedPrice)
kccq_after<- data.frame(item=kccq_wane_after$product,
                         price=kccq_wane_after$discountedPrice)

data.frame(product=c("(8葷12素)小鮮肉麻辣拌(乾拌)",
                     "(8葷12素)小鮮肉麻辣燙(好湯)",
                     "(3葷12素)小仙女麻辣拌(乾拌)",
                     "麻辣鴨血","涼皮","三合一湯"),
           before=c(NA,152.1,NA,45,72.9,49.5),
           after=c(235,235,205,NA,NA,NA))
```

-   前後期菜單有改變，唯一在前後期都有的商品是[小鮮肉麻辣燙]，但漲了83元，讓我好奇兩個品項名稱雖然一樣但內容物是否不同？

##### 二、觀察物價上漲率小於-1的店家，總共有11間
|shopCode | inflation_rate|
|:--------|--------------:|
|u1r2     |      -1.805005|
|we7f     |      -1.582409|
|d1ls     |      -1.494508|
|cysg     |      -1.293129|
|pv5o     |      -1.273706|
|wegr     |      -1.259543|
|alib     |      -1.258040|
|b5cu     |      -1.168680|
|yrcc     |      -1.140915|
|y1nj     |      -1.089684|
|b5vu     |      -1.054621|

```{r,include=FALSE}
filtered_average_inflation_rate_wane|>dplyr::filter(inflation_rate<(-1))|>
  arrange(inflation_rate)
```

##### **shopcode為u1r2店家**
|period | averageCost|
|:------|-----------:|
|before |       182.4|
|after  |        30.0|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wane_before["u1r2"],
                               average_menu_cost_wane_after["u1r2"]))
```

##### u1r2店家的熱門品項

```{r}
popularItems["u1r2"]
```

##### u1r2店家在wane_before的菜單

```{r}
menu_wane$before["u1r2"]|>jsonlite::fromJSON()->u1r2_wane_before
u1r2_wane_before$product
```

##### u1r2店家在wane_after的菜單

```{r}
menu_wane$after["u1r2"]|>jsonlite::fromJSON()->u1r2_wane_after
u1r2_wane_after$product
```

-   after的菜單裡只剩配菜及飲料，主食皆無出現，難以比較前後期價格差異

##### **shopcode為we7f店家**
|period | averageCost|
|:------|-----------:|
|before |         146|
|after  |          30|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wane_before["we7f"],
                               average_menu_cost_wane_after["we7f"]))
```

##### we7f店家的熱門品項

```{r}
popularItems["we7f"]
```

##### we7f店家在wane_before的菜單

```{r}
menu_wane$before["we7f"]|>jsonlite::fromJSON()->we7f_wane_before
we7f_wane_before$product
```

##### we7f店家在wane_after的菜單

```{r}
menu_wane$after["we7f"]|>jsonlite::fromJSON()->we7f_wane_after
we7f_wane_after$product
```

-   前後期菜單有些許不同，但比較兩期皆有的主食[半隻鴨]，價格皆為800，並無作價格上的調整

##### **shopcode為d1ls店家**
|period | averageCost|
|:------|-----------:|
|before |         312|
|after  |          70|

```{r,include=FALSE}
data.frame(period=c("before","after"),
                 averageCost=c(average_menu_cost_wane_before["d1ls"],
                               average_menu_cost_wane_after["d1ls"]))
```

##### d1ls店家的熱門品項

```{r}
popularItems["d1ls"]
```

##### d1ls店家在wane_before的菜單

```{r}
menu_wane$before["d1ls"]|>jsonlite::fromJSON()->d1ls_wane_before
d1ls_wane_before$product
```

##### d1ls店家在wane_after的菜單

```{r}
menu_wane$after["d1ls"]|>jsonlite::fromJSON()->d1ls_wane_after
d1ls_wane_after$product
```
- 由品項名稱可以猜測此間店應該是賣甜甜圈及飲料的店家，但在after的菜單並無出現任何甜甜圈的品項，有可能是品項已售完？


#### 細分persistent_popularItems_count的型態
```{r}
table_persistent_popularItems_count
```


##### **以是否為正餐來討論**
```{r,include=FALSE}
names(persistent_popularItems_count[persistent_popularItems_count==6]) ->shopcode_count_6
names(persistent_popularItems_count[persistent_popularItems_count==5]) ->shopcode_count_5
names(persistent_popularItems_count[persistent_popularItems_count==4]) ->shopcode_count_4
names(persistent_popularItems_count[persistent_popularItems_count==3]) ->shopcode_count_3
names(persistent_popularItems_count[persistent_popularItems_count==2]) ->shopcode_count_2
names(persistent_popularItems_count[persistent_popularItems_count==1]) ->shopcode_count_1
names(persistent_popularItems_count[persistent_popularItems_count==0]) ->shopcode_count_0
```

##### 在三期中產品名稱相同的店家，販售正餐的比例


|ShopCount | Probability|
|:---------|-----------:|
|6         |   0.4671750|
|5         |   0.1688294|
|4         |   0.0922318|
|3         |   0.0607884|
|2         |   0.0426008|
|1         |   0.0222448|
|0         |   0.1461299|

```{r}
total_shops <- sum(
    length(intersect(tracking_shopCodes_mealOffering, shopcode_count_6)),
    length(intersect(tracking_shopCodes_mealOffering, shopcode_count_5)),
    length(intersect(tracking_shopCodes_mealOffering, shopcode_count_4)),
    length(intersect(tracking_shopCodes_mealOffering, shopcode_count_3)),
    length(intersect(tracking_shopCodes_mealOffering, shopcode_count_2)),
    length(intersect(tracking_shopCodes_mealOffering, shopcode_count_1)),
    length(intersect(tracking_shopCodes_mealOffering, shopcode_count_0))
  )
probabilities <- c(
  length(intersect(tracking_shopCodes_mealOffering, shopcode_count_6)) / total_shops,
  length(intersect(tracking_shopCodes_mealOffering, shopcode_count_5)) / total_shops,
  length(intersect(tracking_shopCodes_mealOffering, shopcode_count_4)) / total_shops,
  length(intersect(tracking_shopCodes_mealOffering, shopcode_count_3)) / total_shops,
  length(intersect(tracking_shopCodes_mealOffering, shopcode_count_2)) / total_shops,
  length(intersect(tracking_shopCodes_mealOffering, shopcode_count_1)) / total_shops,
  length(intersect(tracking_shopCodes_mealOffering, shopcode_count_0)) / total_shops
)

data <- data.frame(
  ShopCount = c("6", "5", "4", "3", "2", "1", "0"),
  Probability = probabilities
)

ggplot(data, aes(x = ShopCount, y = Probability)) +
  geom_bar(stat = "identity") +
  labs(x = "Number of Popular Items in Shop",
       y = "Probability of Shops with Meal Offering",
       ) +
  theme_minimal() +
  theme(legend.position = "none")

```



##### **以營業時段來討論**
```{r}
#breakfast時段的店家
names_with_breakfast<-shop_business_hour("breakfast")

#lunch時段的店家
names_with_lunch<-shop_business_hour("lunch")

#dinner時段的店家
names_with_dinner<-shop_business_hour("dinner")

#brunch時段的店家
names_with_brunch<-shop_business_hour("brunch")

#hightea時段的店家
names_with_hightea<-shop_business_hour("hightea")

#bartime時段的店家
names_with_bartime<-shop_business_hour("bartime")

#midnigjt時段的店家
names_with_midnight<-shop_business_hour("midnight")

periods <- c("Breakfast", "Lunch", "Dinner", "Bartime", "Brunch", "Midnight", "Hightea")
```

##### 六個品項的店家當中的營業時間分布    
```{r}
intersection_count_6<-intersection_counts(shopcode_count_6)
pie_plot_business_hours(intersection_count_6)

```

##### 五個品項的店家當中的營業時間分布
```{r}
intersection_count_5<-intersection_counts(shopcode_count_5)
pie_plot_business_hours(intersection_count_5)
```


##### 四個品項的店家當中的營業時間分布
```{r}
intersection_count_4<-intersection_counts(shopcode_count_4)
pie_plot_business_hours(intersection_count_4)
```

##### 三個品項的店家當中的營業時間分布
```{r}
intersection_count_3<-intersection_counts(shopcode_count_3)
pie_plot_business_hours(intersection_count_3)
```

##### 二個品項的店家當中的營業時間分布
```{r}
intersection_count_2<-intersection_counts(shopcode_count_2)
pie_plot_business_hours(intersection_count_2)
```

##### 一個品項的店家當中的營業時間分布
```{r}
intersection_count_1<-intersection_counts(shopcode_count_1)
pie_plot_business_hours(intersection_count_1)
```

##### 零個品項的店家當中的營業時間分布
```{r}
intersection_count_0<-intersection_counts(shopcode_count_0)
pie_plot_business_hours(intersection_count_0)
```


- 可以發現到：不論店家有幾項熱門產品在三期命名相同，這些店家的營業時段多集中在Dinner、Lunch以及Bartime上




##### 選出在breakfast、lunch、dinner提供正餐的shopcode名單
|business_hour | numberOfShop|
|:-------------|------------:|
|breakfast     |         6224|
|lunch         |        23229|
|dinner        |        24814|


```{r,include=FALSE}
offermeal_breakfast<-intersect(names(names_with_breakfast),tracking_shopCodes_mealOffering)
offermeal_lunch<-intersect(names(names_with_lunch),tracking_shopCodes_mealOffering)
offermeal_dinner<-intersect(names(names_with_dinner),tracking_shopCodes_mealOffering)
data.frame(business_hour=c("breakfast","lunch","dinner"),
           numberOfShop=c(length(offermeal_breakfast),length(offermeal_lunch),
                          length(offermeal_dinner)))
```

##### 選出在breakfast、lunch、dinner提供正餐且持續6項的shopcode名單

|business_hour | numberOfShop|
|:-------------|------------:|
|breakfast     |         3514|
|lunch         |        12398|
|dinner        |        12954|

```{r,include=FALSE}
offermeal_6items_breakfast<-intersect(names(names_with_breakfast),tracking_shopCodes_mealOffering_6popularItems)
offermeal_6items_lunch<-intersect(names(names_with_lunch),tracking_shopCodes_mealOffering_6popularItems)
offermeal_6items_dinner<-intersect(names(names_with_dinner),tracking_shopCodes_mealOffering_6popularItems)
data.frame(business_hour=c("breakfast","lunch","dinner"),
           numberOfShop=c(length(offermeal_6items_breakfast),
                          length(offermeal_6items_lunch),
                          length(offermeal_6items_dinner)))
```

#### 以持續六項且供應正餐的店家作討論
|                 | (-Inf,-1]| (-1,0)|     0| (0,1]| (1, Inf]| mean_inflationRates|
|:----------------|---------:|------:|-----:|-----:|--------:|-------------------:|
|summary_cpi_wax  |         0|    279| 11469|  3504|        0|           0.0150506|
|summary_cpi_wane |         0|    263| 12579|  2410|        0|           0.0102684|

```{r,include=FALSE}
tb_cpi_summary
```

##### 計算持續六項且供應正餐的店家的總價格分布
|                         | (0,200]| (200,400]| (400,600]| (600,800]| (800,1000]| (1000,1200]| (1200,1400]| (1400,1600]| (1600,1800]| (1800,2000]| (2000,Inf]|     mean|
|:------------------------|-------:|---------:|---------:|---------:|----------:|-----------:|-----------:|-----------:|-----------:|-----------:|----------:|--------:|
|summary_price_wax_before |     292|      3507|      3524|      2408|       2114|        1482|         694|         435|         256|         179|        361| 748.0810|
|summary_price_wax_after  |     271|      3352|      3562|      2441|       2101|        1550|         706|         434|         277|         179|        379| 757.8407|
|summary_price_wane_after |     253|      3281|      3590|      2401|       2113|        1566|         751|         441|         285|         181|        390| 765.2412|

```{r,include=FALSE}
tb_price_summary
```
##### 計算持續六項且供應正餐的店家的平均價格分布
|                            | (0,50]| (50,100]| (100,150]| (150,200]| (200,250]| (250,Inf]|     mean|
|:---------------------------|------:|--------:|---------:|---------:|---------:|---------:|--------:|
|summary_AvgPrice_wax_before |   1578|     5745|      3535|      2469|       959|       966| 124.6802|
|summary_AvgPrice_wax_after  |   1454|     5731|      3536|      2556|       959|      1016| 126.3068|
|summary_AvgPrice_wane_after |   1388|     5736|      3488|      2592|      1017|      1031| 127.5402|

```{r,include=FALSE}
tb_AvgPrice_summary
```

- 可以看出購買持續六項且供應正餐店家的總價格多數是落在200元至400元的區間，而平均價格多數是落在50元至100元區間。而在三期的表較可以發現平均的價格是有上漲趨勢的

##### 以城市來作分類
|county |         wax_before |         wax_after |          wane_after|
|:------|-------------------:|------------------:|-------------------:|
|臺北市 |            908.0214|           917.2971|            926.2033|
|新竹縣 |            837.1988|           847.5020|            858.9231|
|金門縣 |            808.3214|           809.0357|            818.5000|
|新竹市 |            784.8953|           798.2959|            805.9886|
|新北市 |            770.6656|           779.9671|            788.3362|
|桃園市 |            734.9096|           746.8893|            754.1057|
|嘉義市 |            742.0239|           750.7401|            754.0812|
|澎湖縣 |            733.2778|           748.2778|            748.8333|
|臺中市 |            725.8912|           738.2753|            746.3136|
|基隆市 |            725.7116|           734.4419|            741.9283|
|臺南市 |            712.7912|           721.0766|            726.9040|
|高雄市 |            702.2629|           709.7223|            716.1454|
|屏東縣 |            700.8601|           706.8521|            715.0759|
|雲林縣 |            699.6722|           706.8257|            711.6987|
|南投縣 |            675.7731|           684.4264|            691.7410|
|宜蘭縣 |            671.8995|           682.0323|            688.7941|
|花蓮縣 |            648.6956|           660.9168|            666.4126|
|苗栗縣 |            647.8611|           656.2687|            663.9937|
|彰化縣 |            643.5163|           653.2015|            658.5505|
|嘉義縣 |            619.5929|           631.0282|            636.7814|
|臺東縣 |            593.0000|           597.0000|            617.0000|

```{r,include=FALSE}
tb_price_byGroup_summary|>
  arrange(desc(wane_after_avgPrice))
```
- 以六項商品全購買的總價格來看，並以wane_after這期為標準，前三高分別為台北市、新竹縣以及金門縣
- 直轄市來說，台北市高居第一，而新北市、桃園市分居五、六名，台中市、台南市以及高雄市則是落在第九、第十一以及第十二名。
- 離島地區金門縣高居第三，而澎湖縣位居第八，皆在台中市、台南市及高雄市之上。將金門縣的店家取出觀察，可以發現到在28間店裡就有10間的總商品價格在1000元之上，而這10間餐廳又有6間店是販售單價較高的火鍋，這可能是造成金門縣的商品總價格較高的原因。

###### 金門縣總價格分布
|price     | Freq|
|:---------|----:|
|(0,200]   |    1|
|(200,400] |    3|
|(400,600] |    8|
|(600,800] |    1|
|(800,Inf] |   15|

###### 澎湖縣總價格分布
|price     | Freq|
|:---------|----:|
|(0,200]   |    0|
|(200,400] |    4|
|(400,600] |    5|
|(600,800] |    2|
|(800,Inf] |    7|

##### 以城市來作分類並加入營業時段

- 只顯示前20筆資料(此處的price是wax_before的價格)

|shopCode |county |   price| breakfast| lunch| dinner|
|:--------|:------|-------:|---------:|-----:|------:|
|a008     |基隆市 |  245.00|         0|     0|      1|
|a06a     |臺北市 | 1180.00|         0|     1|      1|
|a08d     |臺南市 |  568.00|         0|     1|      1|
|a0ab     |基隆市 |  785.00|         0|     1|      1|
|a0ac     |基隆市 |  285.00|         1|     1|      0|
|a0ah     |臺中市 |  341.00|         0|     0|      1|
|a0ai     |臺中市 | 1285.00|         0|     1|      1|
|a0aw     |新北市 |  860.00|         0|     1|      1|
|a0bj     |雲林縣 |  855.00|         0|     0|      1|
|a0bm     |新北市 |  965.00|         1|     1|      0|
|a0bp     |新北市 |  345.00|         1|     1|      0|
|a0bx     |高雄市 |  700.00|         0|     1|      1|
|a0cp     |高雄市 |  318.75|         1|     1|      0|
|a0cu     |桃園市 |  500.00|         1|     1|      1|
|a0dd     |嘉義市 |  997.00|         0|     1|      1|
|a0dy     |新北市 | 1190.00|         0|     1|      1|
|a0el     |新北市 | 1020.00|         0|     1|      1|
|a0eo     |雲林縣 |  324.00|         1|     1|      1|
|a0gd     |桃園市 | 2554.00|         0|     0|      1|
|a0gu     |雲林縣 |  425.00|         0|     1|      1|

```{r,include=FALSE}
intersect(names(names_with_breakfast),tracking_shopCodes_mealOffering_6popularItems)->shopCodes_mealOffering_6popularItems_Breakfast
intersect(names(names_with_lunch),tracking_shopCodes_mealOffering_6popularItems)->shopCodes_mealOffering_6popularItems_Lunch
intersect(names(names_with_dinner),tracking_shopCodes_mealOffering_6popularItems)->shopCodes_mealOffering_6popularItems_Dinner

shopcodePrice<-data.frame(shopCode=
                          names(menu_cost_wax_before[tracking_shopCodes_mealOffering_6popularItems]),
                      price=menu_cost_wax_before[tracking_shopCodes_mealOffering_6popularItems])

wax_data_before|>select(shopCode,county)->shopcodeCounty


shopcodeCounty %>%
  dplyr::filter(shopCode %in% tracking_shopCodes_mealOffering_6popularItems)->shopcodeCounty

shopcodeCounty|>left_join(shopcodePrice,by="shopCode")|>
  mutate(county = ifelse(shopCode == "y1ew", "新北市", county))->shopcodeCounty

shopcodeCounty %>%
  mutate(breakfast = ifelse(shopCode %in% shopCodes_mealOffering_6popularItems_Breakfast, 1, 0))|>
  mutate(lunch = ifelse(shopCode %in% shopCodes_mealOffering_6popularItems_Lunch, 1, 0))|>
  mutate(dinner = ifelse(shopCode %in% shopCodes_mealOffering_6popularItems_Dinner, 1, 0)) ->shopcodeCountyBusinessHour
head(shopcodeCountyBusinessHour,20)
```

##### 早餐時段
|county | breakfast| median_price| mean_price| max_price| min_price|
|:------|---------:|------------:|----------:|---------:|---------:|
|南投縣 |         0|      600.000|   767.5487|      4687|    156.00|
|南投縣 |         1|      342.550|   383.2385|       830|    200.00|
|嘉義市 |         0|      660.000|   810.3301|      5700|     85.60|
|嘉義市 |         1|      367.000|   444.1639|      1550|    120.00|
|嘉義縣 |         0|      599.500|   695.9353|      4017|    140.00|
|嘉義縣 |         1|      328.875|   398.2000|      1060|    231.00|
|基隆市 |         0|      720.000|   844.0054|      4282|    180.00|
|基隆市 |         1|      372.500|   434.3049|      1310|    214.00|
|宜蘭縣 |         0|      630.000|   752.1925|      4687|    121.55|
|宜蘭縣 |         1|      393.300|   448.1704|      1940|     97.00|
|屏東縣 |         0|      674.100|   790.4556|      3480|    153.00|
|屏東縣 |         1|      368.500|   428.2336|      2120|    178.20|
|彰化縣 |         0|      656.000|   738.6559|      4017|    123.00|
|彰化縣 |         1|      361.625|   399.7944|      1247|    144.00|
|新北市 |         0|      795.000|   857.7555|      4687|    120.00|
|新北市 |         1|      410.000|   495.4129|      3150|    167.00|
|新竹市 |         0|      760.000|   855.5545|      4017|    145.00|
|新竹市 |         1|      418.000|   520.8532|      3750|    258.40|
|新竹縣 |         0|      770.500|   913.6142|      4017|    175.00|
|新竹縣 |         1|      401.500|   577.9321|      2094|    210.00|
|桃園市 |         0|      730.000|   820.0725|      7090|    119.00|
|桃園市 |         1|      385.000|   474.9385|      2194|    160.00|
|澎湖縣 |         0|      620.000|   766.2667|      1670|    336.00|
|澎湖縣 |         1|      504.000|   568.3333|       891|    310.00|
|臺中市 |         0|      690.000|   791.6898|      4687|    102.00|
|臺中市 |         1|      383.750|   475.6770|      4383|    162.00|
|臺北市 |         0|      890.000|   988.8333|      5646|    135.00|
|臺北市 |         1|      485.000|   594.8510|      2288|    147.00|
|臺南市 |         0|      684.500|   778.6478|      4687|    148.75|
|臺南市 |         1|      397.000|   477.1189|      1995|    190.00|
|臺東縣 |         0|      557.500|   686.2500|      1310|    320.00|
|臺東縣 |         1|      220.000|   220.0000|       220|    220.00|
|花蓮縣 |         0|      602.000|   742.0101|      4017|    141.10|
|花蓮縣 |         1|      347.400|   387.6855|      1195|    193.00|
|苗栗縣 |         0|      575.000|   714.0206|      2340|    135.00|
|苗栗縣 |         1|      350.000|   427.6315|      1360|    200.70|
|金門縣 |         0|      962.500|   887.2273|      1518|    170.00|
|金門縣 |         1|      484.000|   519.0000|       845|    313.00|
|雲林縣 |         0|      650.000|   764.4347|      4687|    140.00|
|雲林縣 |         1|      365.000|   496.5130|      1730|    210.00|
|高雄市 |         0|      670.000|   775.2010|      4687|    108.00|
|高雄市 |         1|      391.000|   472.9645|      2420|    139.00|



```{r,include=FALSE}
shopcodeCountyBusinessHour|>
  group_by(county,breakfast)|>
  summarise(
    median_price = median(price),
    mean_price = mean(price),
    max_price = max(price),
    min_price = min(price)
  )
```

##### 午餐時段

|county | lunch| median_price| mean_price| max_price| min_price|
|:------|-----:|------------:|----------:|---------:|---------:|
|南投縣 |     0|      395.000|   496.5925|    1290.0|    156.00|
|南投縣 |     1|      547.000|   720.2901|    4687.0|    200.00|
|嘉義市 |     0|      410.000|   639.4727|    4250.0|     85.60|
|嘉義市 |     1|      585.000|   773.6096|    5700.0|    120.00|
|嘉義縣 |     0|      302.500|   487.7812|    1336.0|    140.00|
|嘉義縣 |     1|      485.500|   653.6089|    4017.0|    148.75|
|基隆市 |     0|      450.000|   628.5103|    3320.0|    195.00|
|基隆市 |     1|      600.000|   753.4206|    4282.0|    180.00|
|宜蘭縣 |     0|      416.500|   555.1417|    1870.0|    121.55|
|宜蘭縣 |     1|      568.500|   710.0245|    4687.0|     97.00|
|屏東縣 |     0|      458.500|   568.2790|    1644.0|    153.00|
|屏東縣 |     1|      620.000|   729.3109|    3480.0|    168.00|
|彰化縣 |     0|      399.000|   480.5772|    1520.0|    123.00|
|彰化縣 |     1|      568.000|   687.6606|    4017.0|    144.00|
|新北市 |     0|      454.500|   612.1128|    4498.2|    162.00|
|新北市 |     1|      715.000|   807.9625|    4687.0|    120.00|
|新竹市 |     0|      395.000|   638.5900|    3750.0|    145.00|
|新竹市 |     1|      685.000|   814.1564|    4017.0|    255.00|
|新竹縣 |     0|      355.000|   496.7689|    3300.0|    175.00|
|新竹縣 |     1|      765.000|   897.4663|    4017.0|    210.00|
|桃園市 |     0|      433.200|   563.4151|    2554.0|    119.00|
|桃園市 |     1|      649.900|   771.2728|    7090.0|    120.00|
|澎湖縣 |     0|      455.000|   608.6667|    1035.0|    336.00|
|澎湖縣 |     1|      620.000|   758.2000|    1670.0|    310.00|
|臺中市 |     0|      420.000|   540.7583|    3400.0|    102.00|
|臺中市 |     1|      655.000|   772.6696|    4687.0|    106.40|
|臺北市 |     0|      524.000|   717.3777|    3300.0|    135.00|
|臺北市 |     1|      840.000|   936.5964|    5646.0|    147.00|
|臺南市 |     0|      405.500|   554.8159|    3090.0|    148.75|
|臺南市 |     1|      610.000|   746.6003|    4687.0|    170.00|
|臺東縣 |     0|      395.000|   395.0000|     395.0|    395.00|
|臺東縣 |     1|      520.000|   642.5000|    1310.0|    220.00|
|花蓮縣 |     0|      477.000|   628.0475|    1880.0|    141.10|
|花蓮縣 |     1|      519.000|   654.9619|    4017.0|    193.00|
|苗栗縣 |     0|      364.800|   452.0119|    1392.0|    135.00|
|苗栗縣 |     1|      560.000|   700.5594|    2340.0|    135.00|
|金門縣 |     0|      385.000|   420.0000|     730.0|    170.00|
|金門縣 |     1|      945.000|   892.7391|    1518.0|    313.00|
|雲林縣 |     0|      375.775|   484.3190|    2194.0|    140.00|
|雲林縣 |     1|      595.500|   750.8627|    4687.0|    147.00|
|高雄市 |     0|      395.000|   546.9533|    2940.0|    108.00|
|高雄市 |     1|      620.000|   742.1057|    4687.0|    124.20|


```{r,include=FALSE}
shopcodeCountyBusinessHour %>%
  group_by(county,lunch) %>%
  summarise(
    median_price = median(price),
    mean_price = mean(price),
    max_price = max(price),
    min_price = min(price)
  )
```

##### 晚餐時段
|county | dinner| median_price| mean_price| max_price| min_price|
|:------|------:|------------:|----------:|---------:|---------:|
|南投縣 |      0|      342.550|   362.5236|     649.0|    200.00|
|南投縣 |      1|      586.000|   744.1185|    4687.0|    156.00|
|嘉義市 |      0|      356.000|   450.6913|    1550.0|    170.00|
|嘉義市 |      1|      620.500|   789.7153|    5700.0|     85.60|
|嘉義縣 |      0|      263.125|   315.3333|     632.0|    225.00|
|嘉義縣 |      1|      537.500|   674.9129|    4017.0|    140.00|
|基隆市 |      0|      340.000|   362.6357|     960.0|    214.00|
|基隆市 |      1|      684.250|   801.4168|    4282.0|    180.00|
|宜蘭縣 |      0|      369.000|   398.9413|    1680.0|     97.00|
|宜蘭縣 |      1|      620.000|   736.8895|    4687.0|    121.55|
|屏東縣 |      0|      349.350|   358.6000|     615.0|    178.20|
|屏東縣 |      1|      675.000|   794.9045|    3480.0|    153.00|
|彰化縣 |      0|      340.000|   365.1005|    1247.0|    144.00|
|彰化縣 |      1|      600.000|   701.1798|    4017.0|    123.00|
|新北市 |      0|      384.500|   424.6698|    1170.0|    175.00|
|新北市 |      1|      756.900|   831.4025|    4687.0|    120.00|
|新竹市 |      0|      405.000|   470.4925|    2013.0|    258.40|
|新竹市 |      1|      723.000|   839.8953|    4017.0|    145.00|
|新竹縣 |      0|      364.500|   476.6194|    2094.0|    210.00|
|新竹縣 |      1|      760.000|   899.0124|    4017.0|    175.00|
|桃園市 |      0|      350.000|   391.8124|    1040.0|    185.00|
|桃園市 |      1|      695.000|   795.6921|    7090.0|    119.00|
|澎湖縣 |      0|      504.000|   568.3333|     891.0|    310.00|
|澎湖縣 |      1|      620.000|   766.2667|    1670.0|    336.00|
|臺中市 |      0|      350.000|   396.7707|    2240.0|    180.00|
|臺中市 |      1|      674.750|   781.0572|    4687.0|    102.00|
|臺北市 |      0|      436.900|   530.6036|    1800.0|    166.25|
|臺北市 |      1|      870.000|   960.4581|    5646.0|    135.00|
|臺南市 |      0|      355.000|   389.7336|    1640.0|    190.00|
|臺南市 |      1|      660.000|   766.5852|    4687.0|    148.75|
|臺東縣 |      0|      220.000|   220.0000|     220.0|    220.00|
|臺東縣 |      1|      557.500|   686.2500|    1310.0|    320.00|
|花蓮縣 |      0|      345.000|   393.2009|    1195.0|    205.00|
|花蓮縣 |      1|      569.000|   716.5807|    4017.0|    141.10|
|苗栗縣 |      0|      313.500|   342.7426|     582.0|    200.70|
|苗栗縣 |      1|      572.500|   710.7481|    2340.0|    135.00|
|金門縣 |      0|      410.000|   380.3333|     418.0|    313.00|
|金門縣 |      1|      905.000|   859.6800|    1518.0|    170.00|
|雲林縣 |      0|      330.000|   397.4449|    1730.0|    210.00|
|雲林縣 |      1|      645.000|   758.2063|    4687.0|    140.00|
|高雄市 |      0|      360.000|   403.8705|    1487.5|    139.00|
|高雄市 |      1|      646.000|   757.4558|    4687.0|    108.00|


```{r,include=FALSE}
shopcodeCountyBusinessHour %>%
  group_by(county,dinner) %>%
  summarise(
    median_price = median(price),
    mean_price = mean(price),
    max_price = max(price),
    min_price = min(price)
  )
```

